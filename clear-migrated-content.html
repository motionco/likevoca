<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>콘텐츠 데이터 정리</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-2xl mx-auto bg-white rounded-lg shadow-lg p-8">
        <h1 class="text-2xl font-bold text-gray-800 mb-6">콘텐츠 데이터 정리</h1>
        
        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
            <div class="flex items-center">
                <i class="fas fa-exclamation-triangle text-yellow-600 mr-2"></i>
                <span class="font-medium">주의:</span>
            </div>
            <p class="mt-2 text-sm text-yellow-700">
                이 도구는 기존 페이지에서 분리된 후 localStorage에 남아있는 이전 콘텐츠 데이터를 정리합니다.
                기존 FAQ, Manual, Guide 페이지는 원래 정적 콘텐츠로 복원되었으며, 
                새로운 커뮤니티 페이지에서만 동적 콘텐츠를 관리합니다.
            </p>
        </div>

        <div id="status" class="mb-6">
            <h3 class="text-lg font-semibold mb-3">현재 상태</h3>
            <div id="currentStatus" class="text-gray-600">
                확인 중...
            </div>
        </div>

        <div class="space-y-4">
            <button onclick="clearMigratedContent()" class="w-full bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700 transition duration-200">
                <i class="fas fa-trash mr-2"></i>
                이전된 콘텐츠 데이터 삭제
            </button>
            
            <button onclick="showCurrentContent()" class="w-full bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition duration-200">
                <i class="fas fa-eye mr-2"></i>
                현재 저장된 콘텐츠 확인
            </button>
            
            <a href="locales/ko/community.html" class="block w-full bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition duration-200 text-center">
                <i class="fas fa-arrow-right mr-2"></i>
                새로운 커뮤니티 페이지로 이동
            </a>
        </div>

        <div id="result" class="mt-8 hidden">
            <h3 class="text-lg font-semibold mb-3">결과</h3>
            <div id="resultContent" class="bg-gray-50 p-4 rounded-lg"></div>
        </div>
    </div>

    <script>
        // 페이지 로드 시 현재 상태 확인
        document.addEventListener('DOMContentLoaded', checkCurrentStatus);

        function checkCurrentStatus() {
            const currentContent = localStorage.getItem('multilingual_content');
            const statusDiv = document.getElementById('currentStatus');
            
            if (currentContent) {
                try {
                    const content = JSON.parse(currentContent);
                    statusDiv.innerHTML = `
                        <div class="bg-orange-50 border border-orange-200 rounded-lg p-3">
                            <p><strong>${content.length}개</strong>의 콘텐츠가 localStorage에 저장되어 있습니다.</p>
                            <p class="text-sm text-orange-600 mt-1">
                                이는 기존 정적 콘텐츠에서 이전된 데이터입니다. 
                                기존 페이지들이 이미 원래 상태로 복원되었으므로 이 데이터는 더 이상 필요하지 않습니다.
                            </p>
                        </div>
                    `;
                } catch (error) {
                    statusDiv.innerHTML = `
                        <div class="bg-red-50 border border-red-200 rounded-lg p-3">
                            <p class="text-red-600">잘못된 콘텐츠 데이터가 저장되어 있습니다.</p>
                        </div>
                    `;
                }
            } else {
                statusDiv.innerHTML = `
                    <div class="bg-green-50 border border-green-200 rounded-lg p-3">
                        <p class="text-green-600">localStorage가 깨끗합니다. 이전된 콘텐츠 데이터가 없습니다.</p>
                    </div>
                `;
            }
        }

        function clearMigratedContent() {
            const confirmed = confirm('정말로 이전된 콘텐츠 데이터를 삭제하시겠습니까?\n\n이 작업은 되돌릴 수 없으며, 기존 FAQ/Manual/Guide 페이지의 원래 정적 콘텐츠에는 영향을 주지 않습니다.');
            
            if (confirmed) {
                localStorage.removeItem('multilingual_content');
                
                showResult(`
                    <div class="text-green-600">
                        <i class="fas fa-check-circle mr-2"></i>
                        <strong>완료!</strong> 이전된 콘텐츠 데이터가 성공적으로 삭제되었습니다.
                        <div class="mt-3 text-sm bg-green-50 p-3 rounded border">
                            <p><strong>현재 상태:</strong></p>
                            <ul class="list-disc list-inside mt-1 space-y-1">
                                <li>기존 FAQ, Manual, Guide 페이지: 원래 정적 콘텐츠로 복원됨</li>
                                <li>새로운 커뮤니티 페이지: 관리자가 생성하는 동적 콘텐츠 표시</li>
                                <li>localStorage: 깨끗하게 정리됨</li>
                            </ul>
                        </div>
                    </div>
                `);
                
                checkCurrentStatus();
            }
        }

        function showCurrentContent() {
            const currentContent = localStorage.getItem('multilingual_content');
            
            if (currentContent) {
                try {
                    const content = JSON.parse(currentContent);
                    let contentSummary = '<div class="space-y-2">';
                    
                    const typeCounts = content.reduce((acc, item) => {
                        acc[item.type] = (acc[item.type] || 0) + 1;
                        return acc;
                    }, {});
                    
                    contentSummary += '<h4 class="font-semibold mb-2">콘텐츠 유형별 개수:</h4>';
                    Object.entries(typeCounts).forEach(([type, count]) => {
                        const typeNames = {
                            faq: '자주 묻는 질문',
                            manual: '사용자 매뉴얼',
                            guide: '학습 가이드',
                            notices: '공지사항'
                        };
                        contentSummary += `<p>• ${typeNames[type] || type}: ${count}개</p>`;
                    });
                    
                    contentSummary += '</div>';
                    showResult(contentSummary);
                } catch (error) {
                    showResult('<div class="text-red-600">콘텐츠 데이터를 파싱할 수 없습니다.</div>');
                }
            } else {
                showResult('<div class="text-gray-600">저장된 콘텐츠가 없습니다.</div>');
            }
        }

        function showResult(html) {
            const resultDiv = document.getElementById('result');
            const resultContent = document.getElementById('resultContent');
            
            resultContent.innerHTML = html;
            resultDiv.classList.remove('hidden');
        }
    </script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
</body>
</html>