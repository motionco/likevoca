<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LikeVoca - Redirecting...</title>
    <script>
      // 이미 리다이렉트가 실행되었는지 확인
      if (!sessionStorage.getItem('redirected')) {
        // 브라우저 언어 감지
        function detectBrowserLanguage() {
          const browserLang = navigator.language || navigator.userLanguage;
          const langCode = browserLang.split('-')[0];
          
          // 지원하는 언어 목록
          const supportedLanguages = ['ko', 'en', 'ja', 'zh'];
          
          return supportedLanguages.includes(langCode) ? langCode : 'ko';
        }
        
        // 개발 환경 감지
        function isDevelopment() {
          return window.location.hostname === 'localhost' || 
                 window.location.hostname === '127.0.0.1' ||
                 window.location.port === '5500';
        }
        
        // 현재 경로가 이미 언어별 경로인지 확인
        const currentPath = window.location.pathname;
        const isAlreadyLanguagePath = currentPath.match(/^\/(ko|en|ja|zh)\//) || 
                                    currentPath.match(/^\/locales\/(ko|en|ja|zh)\//);
        
        // 이미 언어별 경로가 아닌 경우에만 리다이렉트
        if (!isAlreadyLanguagePath && (currentPath === '/' || currentPath === '/index.html')) {
          // 리다이렉트 실행됨을 표시
          sessionStorage.setItem('redirected', 'true');
          
          const targetLang = detectBrowserLanguage();
          
          if (isDevelopment()) {
            // 개발 환경: locales 폴더 경로 사용
            window.location.replace(`/locales/${targetLang}/index.html`);
          } else {
            // 배포 환경: 언어별 경로 사용
            window.location.replace(`/${targetLang}/index.html`);
          }
        }
      }
      
      // 3초 후 세션 스토리지 정리 (다음 방문을 위해)
      setTimeout(() => {
        sessionStorage.removeItem('redirected');
      }, 3000);
    </script>
  </head>
  <body>
    <div style="display: flex; justify-content: center; align-items: center; height: 100vh; font-family: Arial, sans-serif;">
      <div style="text-align: center;">
        <h2>🌍 LikeVoca</h2>
        <p>언어를 감지하고 있습니다...</p>
        <p>Detecting your language...</p>
        <p style="margin-top: 20px; font-size: 14px; color: #666;">
          자동으로 이동하지 않으면 <a href="/locales/ko/index.html" style="color: #4B63AC;">여기를 클릭하세요</a>
        </p>
      </div>
    </div>
  </body>
</html>