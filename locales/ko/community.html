<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì»¤ë®¤ë‹ˆí‹° - LikeVoca</title>
    
    <meta name="description" content="LikeVoca ì»¤ë®¤ë‹ˆí‹° - í•™ìŠµ ê°€ì´ë“œ, FAQ, ë§¤ë‰´ì–¼ ë° ê³µì§€ì‚¬í•­ì„ í™•ì¸í•˜ì„¸ìš”." />
    
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
    <link rel="stylesheet" href="../../css/style.css" />
</head>
<body class="bg-gray-50">
    <div id="navbar-container"></div>

    <main class="container mx-auto max-w-6xl px-4 md:px-6 lg:px-8 py-8 md:py-12">
        <!-- í—¤ë” ì„¹ì…˜ -->
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-800 mb-6">
                LikeVoca <span class="text-[#4B63AC]">ì»¤ë®¤ë‹ˆí‹°</span>
            </h1>
            <p class="text-lg md:text-xl text-gray-600 max-w-3xl mx-auto">
                ì–¸ì–´í•™ìŠµì— ë„ì›€ì´ ë˜ëŠ” ê°€ì´ë“œ, íŒ, ê³µì§€ì‚¬í•­ì„ í™•ì¸í•˜ì„¸ìš”
            </p>
        </header>

        <!-- ê²€ìƒ‰ ë° í•„í„° -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
            <div class="flex flex-col md:flex-row gap-4 items-center">
                <div class="flex-1">
                    <input 
                        type="text" 
                        id="searchInput" 
                        placeholder="ê¶ê¸ˆí•œ ë‚´ìš©ì„ ê²€ìƒ‰í•´ë³´ì„¸ìš”..." 
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4B63AC]"
                    />
                </div>
                <div class="flex gap-2">
                    <select id="categoryFilter" class="px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4B63AC]">
                        <option value="all">ì „ì²´ ì¹´í…Œê³ ë¦¬</option>
                        <option value="notices">ê³µì§€ì‚¬í•­</option>
                        <option value="guide">í•™ìŠµ ê°€ì´ë“œ</option>
                        <option value="faq">ìì£¼ ë¬»ëŠ” ì§ˆë¬¸</option>
                        <option value="manual">ì‚¬ìš©ì ë§¤ë‰´ì–¼</option>
                    </select>
                    <button id="searchBtn" class="bg-[#4B63AC] text-white px-6 py-3 rounded-lg hover:bg-[#3A4F8B] transition duration-200">
                        <i class="fas fa-search"></i>
                    </button>
                    <button id="refreshBtn" class="bg-gray-600 text-white px-6 py-3 rounded-lg hover:bg-gray-700 transition duration-200" title="ì½˜í…ì¸  ìƒˆë¡œê³ ì¹¨">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- ë¡œë”© ìƒíƒœ -->
        <div id="loading" class="text-center py-12">
            <i class="fas fa-spinner fa-spin text-3xl text-gray-400 mb-4"></i>
            <p class="text-gray-600">ì½˜í…ì¸ ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
        </div>
        
        <!-- ì½˜í…ì¸  ëª©ë¡ -->
        <div id="contentList" class="space-y-6">
        </div>

        <!-- ë¹ˆ ìƒíƒœ -->
        <div id="emptyState" class="text-center py-12 hidden">
            <i class="fas fa-search text-6xl text-gray-300 mb-6"></i>
            <h3 class="text-xl font-semibold text-gray-700 mb-2">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</h3>
            <p class="text-gray-500">ë‹¤ë¥¸ ê²€ìƒ‰ì–´ë¥¼ ì‚¬ìš©í•´ë³´ì„¸ìš”.</p>
        </div>
    </main>

    <!-- Footer -->
    <div id="footer-container"></div>

    <!-- Scripts -->
    <script src="../../components/js/navbar.js"></script>
    <script src="../../components/js/footer.js"></script>
    
    <script type="module">
        import { applyLanguage, updateMetadata } from '../../utils/language-utils.js';
        
        let contentData = [];
        
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // ë„¤ë¹„ê²Œì´ì…˜ë°” ë¡œë“œ
                if (typeof window.loadNavbar === 'function') {
                    await window.loadNavbar();
                }
                
                // Footer ë¡œë“œ
                if (typeof window.loadFooter === 'function') {
                    await window.loadFooter();
                }
                
                // ì–¸ì–´ ì ìš©
                await applyLanguage();
                await updateMetadata('community');
                
                // ì½˜í…ì¸  ë¡œë“œ
                await loadContentData();
                await displayContent();
                
                // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
                setupEventListeners();
                
            } catch (error) {
                console.error('ì»¤ë®¤ë‹ˆí‹° í˜ì´ì§€ ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜:', error);
                showError('í˜ì´ì§€ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        });

        // ì½˜í…ì¸  ë°ì´í„° ë¡œë“œ
        async function loadContentData() {
            try {
                console.log('ğŸ“Š ì½˜í…ì¸  ë°ì´í„° ë¡œë“œ ì‹œë„...');
                
                // localStorageì—ì„œ ì½˜í…ì¸  ë¡œë“œ
                const localContent = localStorage.getItem('multilingual_content');
                if (localContent) {
                    contentData = JSON.parse(localContent);
                    console.log(`âœ… localStorageì—ì„œ ${contentData.length}ê°œ ì½˜í…ì¸  ë¡œë“œ`);
                } else {
                    console.log('ğŸ“ localStorageê°€ ë¹„ì–´ìˆìŒ, ìƒ˜í”Œ ë°ì´í„° ìƒì„±...');
                    contentData = generateSampleContent();
                    localStorage.setItem('multilingual_content', JSON.stringify(contentData));
                    console.log(`âœ… ìƒ˜í”Œ ì½˜í…ì¸  ${contentData.length}ê°œ ìƒì„±`);
                }
                
            } catch (error) {
                console.error('âŒ ì½˜í…ì¸  ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                contentData = generateSampleContent();
            }
        }

        // ìƒ˜í”Œ ì½˜í…ì¸  ìƒì„±
        function generateSampleContent() {
            const currentTime = new Date().toISOString();
            
            return [
                {
                    id: 'welcome_001',
                    type: 'notices',
                    priority: 'high',
                    createdAt: currentTime,
                    updatedAt: currentTime,
                    versions: {
                        ko: {
                            title: 'LikeVoca ì»¤ë®¤ë‹ˆí‹°ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤!',
                            content: '<div class="prose max-w-none"><h2>ğŸ‰ ì»¤ë®¤ë‹ˆí‹° ì˜¤í”ˆ!</h2><p>ì–¸ì–´í•™ìŠµì— ë„ì›€ì´ ë˜ëŠ” ë‹¤ì–‘í•œ ê°€ì´ë“œì™€ íŒì„ ê³µìœ í•˜ëŠ” ìƒˆë¡œìš´ ì»¤ë®¤ë‹ˆí‹° ê³µê°„ì´ ì˜¤í”ˆë˜ì—ˆìŠµë‹ˆë‹¤.</p><ul><li>í•™ìŠµ ê°€ì´ë“œ ë° ì „ëµ</li><li>ìƒˆë¡œìš´ ê¸°ëŠ¥ ì•ˆë‚´</li><li>ê³µì§€ì‚¬í•­ ë° ì—…ë°ì´íŠ¸</li></ul><p>ì—¬ëŸ¬ë¶„ì˜ ì–¸ì–´í•™ìŠµ ì—¬ì •ì— ë„ì›€ì´ ë˜ëŠ” ìœ ìš©í•œ ì •ë³´ë“¤ì„ ì°¾ì•„ë³´ì„¸ìš”!</p></div>',
                            published: true,
                            lastModified: currentTime,
                            translationStatus: 'updated'
                        }
                    }
                },
                {
                    id: 'guide_001',
                    type: 'guide',
                    priority: 'high',
                    createdAt: currentTime,
                    updatedAt: currentTime,
                    versions: {
                        ko: {
                            title: 'íš¨ê³¼ì ì¸ ë‹¨ì–´ í•™ìŠµ ì „ëµ',
                            content: '<div class="prose max-w-none"><h2>ğŸ“š ë‹¨ì–´ í•™ìŠµì˜ ê³¼í•™ì  ì ‘ê·¼ë²•</h2><p>ì–¸ì–´í•™ìŠµì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ ê²ƒ ì¤‘ í•˜ë‚˜ëŠ” ì–´íœ˜ í•™ìŠµì…ë‹ˆë‹¤. ì—¬ê¸° íš¨ê³¼ì ì¸ ë‹¨ì–´ í•™ìŠµ ì „ëµì„ ì†Œê°œí•©ë‹ˆë‹¤.</p><h3>ğŸ”„ ê°„ê²© ë°˜ë³µ í•™ìŠµë²•</h3><ul><li>1ì¼ í›„: ì²« ë²ˆì§¸ ë³µìŠµ</li><li>3ì¼ í›„: ë‘ ë²ˆì§¸ ë³µìŠµ</li><li>1ì£¼ì¼ í›„: ì„¸ ë²ˆì§¸ ë³µìŠµ</li><li>2ì£¼ì¼ í›„: ë„¤ ë²ˆì§¸ ë³µìŠµ</li></ul><h3>ğŸ¯ ëŠ¥ë™ì  íšŒìƒë²•</h3><p>ë‹¨ìˆœíˆ ì½ê¸°ë³´ë‹¤ëŠ” ì§ì ‘ ìƒê°í•´ë‚´ëŠ” ê²ƒì´ íš¨ê³¼ì ì…ë‹ˆë‹¤.</p></div>',
                            published: true,
                            lastModified: currentTime,
                            translationStatus: 'updated'
                        }
                    }
                },
                {
                    id: 'faq_001',
                    type: 'faq',
                    priority: 'normal',
                    createdAt: currentTime,
                    updatedAt: currentTime,
                    versions: {
                        ko: {
                            title: 'LikeVocaë¥¼ ì²˜ìŒ ì‹œì‘í•˜ëŠ” ë°©ë²•ì€?',
                            content: '<div class="prose max-w-none"><p>LikeVocaë¥¼ ì²˜ìŒ ì‚¬ìš©í•˜ì‹œëŠ” ë¶„ë“¤ì„ ìœ„í•œ ê°„ë‹¨í•œ ê°€ì´ë“œì…ë‹ˆë‹¤:</p><ol><li><strong>ê³„ì • ìƒì„±</strong>: ì´ë©”ì¼ë¡œ ê°€ì…í•˜ê±°ë‚˜ Google/Facebook ì†Œì…œ ë¡œê·¸ì¸ì„ ì´ìš©í•˜ì„¸ìš”.</li><li><strong>ë ˆë²¨ í…ŒìŠ¤íŠ¸</strong>: ê°„ë‹¨í•œ ì–´íœ˜ í…ŒìŠ¤íŠ¸ë¡œ ë‚´ ìˆ˜ì¤€ì„ í™•ì¸í•´ë³´ì„¸ìš”.</li><li><strong>AI ë‹¨ì–´ ì¶”ì²œ</strong>: ë‚´ ìˆ˜ì¤€ì— ë§ëŠ” ë‹¤ì–‘í•œ ë‹¨ì–´ë“¤ì„ ë§Œë‚˜ë³´ì„¸ìš”.</li><li><strong>ê²Œì„ìœ¼ë¡œ í•™ìŠµ</strong>: ì¬ë¯¸ìˆëŠ” ê²Œì„ìœ¼ë¡œ ë‹¨ì–´ë¥¼ ìµí˜€ë³´ì„¸ìš”!</li></ol></div>',
                            published: true,
                            lastModified: currentTime,
                            translationStatus: 'updated'
                        }
                    }
                }
            ];
        }

        // ì½˜í…ì¸  í‘œì‹œ
        async function displayContent() {
            const loading = document.getElementById('loading');
            const contentList = document.getElementById('contentList');
            const emptyState = document.getElementById('emptyState');
            
            if (!loading || !contentList || !emptyState) {
                console.error('í•„ìˆ˜ DOM ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤:', {
                    loading: !!loading,
                    contentList: !!contentList,
                    emptyState: !!emptyState
                });
                return;
            }
            
            loading.style.display = 'block';
            emptyState.classList.add('hidden');
            
            try {
                const searchInput = document.getElementById('searchInput');
                const categoryFilterElement = document.getElementById('categoryFilter');
                
                if (!searchInput || !categoryFilterElement) {
                    console.error('ê²€ìƒ‰/í•„í„° DOM ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤:', {
                        searchInput: !!searchInput,
                        categoryFilter: !!categoryFilterElement
                    });
                    showError('í˜ì´ì§€ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                
                const searchTerm = searchInput.value.toLowerCase();
                const categoryFilter = categoryFilterElement.value;
                
                // í•„í„°ë§
                let filteredContent = contentData.filter(item => {
                    const version = item.versions.ko;
                    if (!version || !version.published) return false;
                    
                    // ì¹´í…Œê³ ë¦¬ í•„í„°
                    if (categoryFilter !== 'all' && item.type !== categoryFilter) return false;
                    
                    // ê²€ìƒ‰ í•„í„°
                    if (searchTerm) {
                        const titleMatch = version.title.toLowerCase().includes(searchTerm);
                        const contentMatch = version.content.toLowerCase().includes(searchTerm);
                        if (!titleMatch && !contentMatch) return false;
                    }
                    
                    return true;
                });
                
                if (filteredContent.length === 0) {
                    contentList.innerHTML = '';
                    emptyState.classList.remove('hidden');
                } else {
                    renderContent(filteredContent);
                    emptyState.classList.add('hidden');
                }
                
            } catch (error) {
                console.error('ì½˜í…ì¸  í‘œì‹œ ì‹¤íŒ¨:', error);
                showError('ì½˜í…ì¸ ë¥¼ í‘œì‹œí•˜ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            } finally {
                loading.style.display = 'none';
            }
        }

        // ì½˜í…ì¸  ë Œë”ë§
        function renderContent(content) {
            const contentList = document.getElementById('contentList');
            
            const categoryIcons = {
                notices: 'fa-bullhorn',
                guide: 'fa-compass',
                faq: 'fa-question-circle',
                manual: 'fa-book'
            };
            
            const categoryNames = {
                notices: 'ê³µì§€ì‚¬í•­',
                guide: 'í•™ìŠµ ê°€ì´ë“œ',
                faq: 'ìì£¼ ë¬»ëŠ” ì§ˆë¬¸',
                manual: 'ì‚¬ìš©ì ë§¤ë‰´ì–¼'
            };
            
            const html = content.map(item => {
                const version = item.versions.ko;
                const excerpt = stripHtml(version.content).substring(0, 150) + '...';
                
                return `
                    <article class="bg-white rounded-xl shadow-lg p-6 hover:shadow-xl transition duration-300">
                        <div class="flex items-start justify-between mb-4">
                            <div class="flex items-center space-x-3">
                                <div class="w-12 h-12 rounded-lg bg-[#4B63AC] bg-opacity-10 flex items-center justify-center">
                                    <i class="fas ${categoryIcons[item.type]} text-[#4B63AC] text-lg"></i>
                                </div>
                                <div>
                                    <h3 class="text-xl font-semibold text-gray-900 mb-1">
                                        ${version.title}
                                    </h3>
                                    <div class="flex items-center space-x-3">
                                        <span class="text-sm text-gray-500">${categoryNames[item.type]}</span>
                                        <span class="text-sm text-gray-400">${formatDate(item.updatedAt)}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="text-gray-600 mb-4">
                            ${excerpt}
                        </div>
                        
                        <button onclick="openContentDetail('${item.id}')" class="text-[#4B63AC] hover:text-[#3A4F8B] font-medium">
                            <i class="fas fa-arrow-right mr-2"></i>
                            ìì„¸íˆ ë³´ê¸°
                        </button>
                    </article>
                `;
            }).join('');
            
            contentList.innerHTML = html;
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        function setupEventListeners() {
            document.getElementById('searchBtn').addEventListener('click', displayContent);
            document.getElementById('refreshBtn').addEventListener('click', async () => {
                console.log('ğŸ”„ ìˆ˜ë™ ìƒˆë¡œê³ ì¹¨ ì‹¤í–‰...');
                await loadContentData();
                await displayContent();
            });
            document.getElementById('searchInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') displayContent();
            });
            document.getElementById('categoryFilter').addEventListener('change', displayContent);
        }

        // ìƒì„¸ë³´ê¸°
        window.openContentDetail = function(contentId) {
            const content = contentData.find(item => item.id === contentId);
            if (!content) return;
            
            const version = content.versions.ko;
            if (!version) return;
            
            // ê°„ë‹¨í•œ ëª¨ë‹¬ í‘œì‹œ
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                    <div class="p-6 border-b">
                        <div class="flex items-center justify-between">
                            <h2 class="text-2xl font-bold text-gray-900">${version.title}</h2>
                            <button onclick="this.closest('.fixed').remove()" class="text-gray-500 hover:text-gray-700">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                    </div>
                    <div class="p-6">
                        <div class="prose max-w-none">
                            ${version.content}
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        };

        // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤
        function stripHtml(html) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = html;
            return tempDiv.textContent || tempDiv.innerText || '';
        }

        function formatDate(dateString) {
            if (!dateString) return '-';
            const date = new Date(dateString);
            return date.toLocaleDateString('ko-KR', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }

        function showError(message) {
            const contentList = document.getElementById('contentList');
            contentList.innerHTML = `
                <div class="text-center py-12">
                    <i class="fas fa-exclamation-triangle text-4xl text-red-400 mb-4"></i>
                    <p class="text-red-600">${message}</p>
                </div>
            `;
        }
    </script>
</body>
</html>